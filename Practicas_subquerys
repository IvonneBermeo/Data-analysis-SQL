--posiciona en la base de datos
use PEDIDOS 
go 
/*
MOSTRAR TODAS LAS CATEGORIAS 
*/

SELECT * FROM [dbo].[CATEGORIAS]
---	SUBQUERYS CONDICIONALES----
/*
MOSTRAR LOS PRODUCTOS QUE ESTEN EN LA TABLA CATEGORIAS
*/
SELECT *FROM PRODUCTOS
WHERE CATEGORIAID IN (SELECT CATEGORIAID FROM CATEGORIAS)


/*
MOSTRAR LOS DETALLES DE ORDENES QUE EXISTAN EN LA TABLA ORDENES 
*/
SELECT *FROM DETALLE_ORDENES
WHERE ORDENID IN (SELECT ORDENID FROM ORDENES)

/*
MOSTRAR TODOS LOS PRODUCTOS CON EL NOMBRE DE SU CATEGORIA 
*/
SELECT 
	PRODUCTOID,
	PROVEEDORID,
	CATEGORIAID,
	(SELECT NOMBRECAT FROM CATEGORIAS AS B
		WHERE B.CATEGORIAID=A.CATEGORIAID) AS NombreCategoria,
	DESCRIPCION,
	PRECIOUNIT,
	EXISTENCIA

FROM PRODUCTOS AS A




/* TAREA 

MOSTRAR LOS DETALLES DE ORDENES ADICIONAL DE PRESENTAR EL NOMBRE DEL PRODUCTO, 
Nota:
SE DEBE SOLO PRESENTAR AQUELLOS DETALLE de ORDENES QUE TENGAN LOS CODIGOS 30,50,60,70

*/

SELECT 
	DETALLEID,
	(SELECT [DESCRIPCION]  FROM [dbo].[PRODUCTOS] as B 
	WHERE B.PRODUCTOID=A.PRODUCTOID) AS Nombre_Producto
	FROM [dbo].[DETALLE_ORDENES] as A
	WHERE DETALLEID IN(30,50,60,70)


--- SI FUERA SOLO LOS DETALLES DE ORDENES ADICIONAL DE PRESENTAR EL NOMBRE DEL PRODUCTO y ordenados de menor a mayor, 
SELECT 
	DETALLEID,
	(SELECT [DESCRIPCION]  FROM [dbo].[PRODUCTOS] as B 
	WHERE B.PRODUCTOID=A.PRODUCTOID) AS Nombre_Producto
	FROM [dbo].[DETALLE_ORDENES] as A 
	order by DETALLEID asc;
